<div class="d-flex justify-content-center mb-4">
  <button class="btn btn-primary" (click)="addUser()"> <i class="bi bi-plus ps-2"></i> Create a user</button>
</div>
<div class="d-flex justify-content-center mb-4">
  Or
</div>

<alto-dropzone [multiple]="false" (change)="onSelectUser($event)">
  <span subtitle class="fs-7">Following the CSV format : <i>firstname, lastname, email, role</i></span>
</alto-dropzone>
<br />

<div *ngIf="displayedUsers.length > 0 && showUserList" class="table-container table-panel">
  <table class="table">
    <thead>
      <tr>
        <th>name</th>
        <th>email</th>
        <th>Role</th>
        <th scope="col" class="action-btn-list"></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let user of displayedUsers; let index = index">
        <td>
          <div>{{ user.firstname }} {{ user.lastname }}</div>
        </td>
        <td>
          <span>{{ user.email }}</span>
        </td>
        <td>
          <span
            *ngFor="let role of user.roles"
            class="alto-badge text-white me-1 mb-1"
            [style.backgroundColor]="role | role2BackgroundColor"
            [style.color]="role | role2color"
            >{{ role }}</span
          >
        </td>
        <td class="action-btn-list-container">
          <div class="shaddow"></div>
          <div class="d-flex action-btn-list align-items-center gap-2">
            <button type="button" class="btn btn-link" (click)="deleteUser(user)">
              <i class="alto-second-grey bi bi-trash"></i>
            </button>
            <button type="button" class="btn btn-link" (click)="openEditUserForm(user)">
              <i class="alto-second-grey bi bi-pencil"></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
  <div class="px-2">
    <alto-pagination
      [(page)]="page"
      [collectionSize]="csvData.length"
      [pageSize]="pageSize"
      (pageChange)="refreshUsers()"
    ></alto-pagination>
  </div>
</div>

<div *ngIf="displayedUsers.length > 0" class="d-flex align-items-center justify-content-center pt-3">
  <button type="button" class="btn btn-outline-secondary" (click)="showUserList = !showUserList">
    {{ showUserList ? 'Mask users list' : 'Show users list' }}
  </button>
</div>

<div *ngIf="usersFailed.length > 0" class="table-panel mt-4 p-4 pill-red">
  <h5 class="alto-red">Users Failed</h5>
  <p class="alto-grey mb-3">We encountered issues with these users. Please make sure they follow  the CSV format :</p>  
  <ul *ngFor="let us of usersFailed" class="mb-1">{{us}}</ul>
</div>
